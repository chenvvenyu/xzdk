(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/addressEdit"],{"1a85":function(e,t,n){"use strict";(function(e){n("03cd");s(n("66fd"));var t=s(n("6c2d"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"451f":function(e,t,n){"use strict";n.r(t);var s=n("fdb8"),o=n.n(s);for(var i in s)"default"!==i&&function(e){n.d(t,e,(function(){return s[e]}))}(i);t["default"]=o.a},5388:function(e,t,n){"use strict";var s=n("5438"),o=n.n(s);o.a},5438:function(e,t,n){},"6c2d":function(e,t,n){"use strict";n.r(t);var s=n("9618"),o=n("451f");for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("5388");var r,a=n("f0c5"),d=Object(a["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);t["default"]=d.exports},9618:function(e,t,n){"use strict";var s;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s}));var o=function(){var e=this,t=e.$createElement;e._self._c},i=[]},fdb8:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(n("7a58")),o=n("2f62"),i=r(n("96cd"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=n("55c6"),u={data:function(){return{Title:"编辑",ID:"",Lng:"",Lat:"",Address:"",Address2:"",Address3:"",Name:"",Phone:"",Province:"",City:"",District:"",IsDefault:!1,type:2,polygons:[],is_location:!1,RegionID:0,Region:""}},computed:d({},(0,o.mapState)(["hasLogin","userInfo"])),methods:{MoneyRadioChange:function(){this.IsDefault=!this.IsDefault},GetGeo:function(e){if(!s.default.IsNull(e)){var t=this,n=new c.BMapWX,o="浙江省义乌市";n.geocoding({address:o+e,async:!0,success:function(e){console.log(e.result.location);var n=e.result.location;n&&(t.Lng=n.lng,t.Lat=n.lat,t.Address=t.Address2,t.Address2="")},fail:function(e){console.log(e),t.showMsg("地址无效，请修改后重试")}})}},clickConfirm:function(){var t=this,n=t.AreaV,o=[];if(n){var i=!1,r=/[1][3-9]\d{9}/g,a=n.match(r);if(null!=a&&a.length>0)n=n.replace(a[0],","+a[0]+",");else{var d=/0?(579)?8[1-9]{7}/g,l=n.match(d);null!=l&&l.length>0&&(n=n.replace(l[0],","+l[0]+","))}n=n.replace(/[\n，, ]+/g,","),n=n.split(",");for(var c=0;c<n.length;c++)s.default.IsPhone(n[c])||s.default.IsFixPhone(n[c])?(i=!0,t.Phone=n[c]):o.push(n[c]);if(!i)return e.showToast({icon:"none",title:"未识别出有效的电话号码"});console.log("arr",o),o[0].length<o[1].length&&(t.Name=o[0],t.Address2=o[1],t.is_location=!0),o[0].length>o[1].length&&(t.Name=o[1],t.Address2=o[0],t.Lat=0,t.is_location=!0),t.GetGeo(t.Address2)}},ChooseArea:function(){var t=this;0==t.Lat.length?(console.log("新增"),e.chooseLocation({success:function(e){t.Lng=e.longitude,t.Lat=e.latitude,t.Address=e.name,t.Address3=e.address,t.RegionID=0,t.Region="",t.location=!0}})):e.chooseLocation({latitude:t.Lat,longitude:t.Lng,success:function(e){t.Lng=e.longitude,t.Lat=e.latitude,t.Address=e.name,t.Address3=e.address,t.RegionID=0,t.Region="",t.location=!1}})},CheckIsPtInPoly:function(){var t=this;if(!t.polygons||t.polygons.length<1)return t.Address="",e.showToast({icon:"none",title:"该区域未开通服务"});for(var n=!1,s=0;s<t.polygons.length;s++)if(n=i.default.IsPtInPoly(t.locationAddr.latitude,t.locationAddr.longitude,t.polygons[s].points),!0===n)return t.is_location=!1,t.RegionID=t.regionList[s].ID,t.Region=t.regionList[s].Name,t.Address=t.locationAddr.name,t.Address3=t.locationAddr.address,t.Province=t.regionList[s].Province,t.City=t.regionList[s].City,t.District=t.regionList[s].District,t.Lat=t.locationAddr.latitude,void(t.Lng=t.locationAddr.longitude);t.Address="",e.showToast({icon:"none",title:"该区域未开通服务"})},currDistrict:function(t){console.log("currDistrict");var n=this;n.Get("/api/Region/GetRegionListByAddress?district=义乌市","",n.userInfo.accessToken,(function(s){if(!s.Status)return e.showToast({icon:"none",title:"网络信号太差，定位失败"});if(s.Data&&s.Data.length>0){n.regionList=s.Data;for(var o=0;o<s.Data.length;o++){var i={points:[],strokeWidth:1,strokeColor:"#000000",fillColor:"#ffffff"},r=JSON.parse(s.Data[o].RangeGCJ02);if(r&&r.length>0)for(var a=0;a<r.length;a++){var d={latitude:r[a].lat,longitude:r[a].lng};i.points.push(d)}n.polygons.push(i)}t()}else n.polygons=[],n.regionList=[]}),"biz")},PageReload:function(e){var t=this;null!=e&&(t.Lng=e.Lng,t.Lat=e.Lat,t.Address=e.Address,t.Address2=e.Address2,t.Address3=e.Address3,t.Province=e.Province,t.City=e.City,t.District=e.District,t.IsDefault=e.IsDefault,t.RegionID=e.RegionID,t.Region=e.RegionName)},btnSubmit:function(){var t=this;if(s.default.IsNull(t.Lng)||s.default.IsNull(t.Lat)||s.default.IsNull(t.Address)){if(s.default.IsNull(t.Address2))return void t.showMsg("请选择定位或填写地址");t.GetGeo(t.Address2)}if(s.default.IsNull(t.Name))t.showMsg("请输入联系人姓名！");else if(0!=t.Phone.length)if(s.default.IsPhone(t.Phone)||s.default.IsFixPhone(t.Phone)){var n=Number(t.ID)<=0?"/api/User/CreateCommonlyUsedContact":"/api/User/UpdateCommonlyUsedContact",o=t.Address?t.Address:"",i=t.Address2?t.Address2:"",r=t.Address3?t.Address3:"",a={id:t.ID,fullName:t.Name,phone:t.Phone,address:o,address2:i,address3:r,regionID:t.RegionID,regionName:t.Region,remark:"",province:t.Province,city:t.City,district:t.District,lng:t.Lng,lat:t.Lat,IsDefault:t.IsDefault};Number(t.ID)<=0&&(a.type=t.type),t.POST(n,a,t.userInfo.accessToken,(function(n){if(n.Status){t.showMsg("操作成功！");var o=getCurrentPages();if(s.default.IsNull(t.Lng)||s.default.IsNull(t.Lng)||s.default.IsNull(t.Address))return t.showMsg("网络繁忙，请重试"),void console.log("空值，不能提交");console.log("可以返回提交");var i={Lng:t.Lng,Lat:t.Lat,Province:t.Province,City:t.City,District:t.District,RegionID:t.RegionID,Region:t.Region,Address:t.Address,Address2:t.Address2,Address3:t.Address3,Name:t.Name,Phone:t.Phone};if("pages/index/index"==o[o.length-3].route){var r="2"===t.type?"mailing":"receipt",a=o[o.length-3];a.$vm.PageReload(i,r,t.Address,t.Address2),e.navigateBack({delta:2})}else{var d=o[o.length-2];d.$vm.loadData(),e.navigateBack({delta:1})}}else t.showMsg(n.Message)}))}else t.showMsg("请输入有效的电话号码");else t.showMsg("请输入联系人电话！")}},onLoad:function(e){var t=this,n=e.data;if(t.type=e.type,console.log(t.type),!s.default.IsNull(n)){var o=JSON.parse(decodeURIComponent(n));console.log("_item",o),t.ID=o.ID,t.RegionID=o.RegionID,t.Region=o.Region,t.Address=o.Address,t.Address2=o.Address2,t.Address3=o.Address3,t.Phone=o.Phone,t.Name=o.FullName,t.Province=o.Province,t.City=o.City,t.District=o.District,t.Lng=o.Lng,t.Lat=o.Lat,t.IsDefault=o.IsDefault}!s.default.IsInt(t.ID)||Number(t.ID)<0?(t.Title="添加",t.ID=-1):t.Title="编辑"}};t.default=u}).call(this,n("543d")["default"])}},[["1a85","common/runtime","common/vendor"]]]);
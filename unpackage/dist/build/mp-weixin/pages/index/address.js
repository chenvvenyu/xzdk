(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/address"],{"44a4":function(e,n,o){"use strict";(function(e){o("03cd");t(o("66fd"));var n=t(o("a431"));function t(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,o("543d")["createPage"])},4639:function(e,n,o){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=i(o("626c")),s=o("2f62"),r=i(o("96cd"));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function a(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?l(Object(o),!0).forEach((function(n){d(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function d(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var c=o("55c6"),u={data:function(){return{Agreement:!1,Type:"mailing",Title:"寄件人信息",Lng:"",Lat:"",Province:"",City:"",District:"",RegionID:0,Region:"",Address:"",Address2:"",Address3:"",Name:"",Phone:""}},computed:a({},(0,s.mapState)(["hasLogin","userInfo"])),methods:{agreementChange:function(){var e=this;e.Agreement=!e.Agreement},ChooseArea:function(){var n=this;n.Lng>0&&n.Lat>0?e.chooseLocation({longitude:n.Lng,latitude:n.Lat,success:function(e){n.Lng=e.longitude,n.Lat=e.latitude,n.Address=e.name,n.Address3=e.address,n.RegionID=0,n.Region="",n.location=!1}}):(console.log("定位当前位置"),e.chooseLocation({success:function(e){n.Lng=e.longitude,n.Lat=e.latitude,n.Address=e.name,n.Address3=e.address,n.RegionID=0,n.Region="",n.location=!1}}))},CheckIsPtInPoly:function(){console.log("CheckIsPtInPoly");var n=this;if(!n.polygons||n.polygons.length<1)return n.Address="",e.showToast({icon:"none",title:"该区域未开通服务"});for(var o=!1,t=0;t<n.polygons.length;t++)if(o=r.default.IsPtInPoly(n.locationAddr.latitude,n.locationAddr.longitude,n.polygons[t].points),!0===o)return"receipt"==n.Type?n.Title="收件人信息":n.Title="寄件人信息",n.Lng=n.locationAddr.longitude,n.Lat=n.locationAddr.latitude,n.Province=n.regionList[t].Province,n.City=n.regionList[t].City,n.District=n.regionList[t].District,n.Address=n.locationAddr.name,n.Address2="",n.Address3=n.locationAddr.address,n.RegionID=n.regionList[t].ID,n.Region=n.regionList[t].Name,void(n.location=!1);n.Address="",e.showToast({icon:"none",title:"该区域未开通服务"})},GetGeo:function(e){if(console.log(e),!t.default.IsNull(e)){var n=this,o=new c.BMapWX,s="浙江省义乌市";o.geocoding({address:s+e,async:!0,success:function(e){console.log(e.result.location);var o=e.result.location;o&&(n.Lng=o.lng,n.Lat=o.lat,n.Address=n.Address2,n.Address2="")},fail:function(e){console.log(e),n.showMsg("地址无效，请修改后重试")}})}},autoConfirm:function(n){var o=n.detail.value,s=this,r=[];if(o){var i=!1;o=o.replace(/[\n，, ]+/g,","),console.log("v",o),o=o.split(",");for(var l=0;l<o.length;l++)t.default.IsPhone(o[l])?(i=!0,s.Phone=o[l]):r.push(o[l]);if(!i)return e.showToast({icon:"none",title:"未识别出11位手机号码"});console.log("arr",r),r[0].length<r[1].length&&(s.Name=r[0],s.Address2=r[1],s.location=!0),r[0].length>r[1].length&&(s.Name=r[1],s.Address2=r[0],s.location=!0)}},clickConfirm:function(){var n=this,o=n.AreaV,s=[];if(o){console.log(o),o=o.replace("收货人：",","),o=o.replace("收货地址：",","),o=o.replace("手机：",","),console.log(o);var r=!1,i=/[1][3-9]\d{9}/g;i.test(o);var l=o.match(i);if(null!=l&&l.length>0)o=o.replace(l[0],","+l[0]+",");else{console.log("固定电话识别");var a=/0?(579)?8[1-9]{7}/g,d=o.match(a);null!=d&&d.length>0&&(o=o.replace(d[0],","+d[0]+","))}o=o.replace(/[\n，, ]+/g,","),o=o.split(",");for(var c=0;c<o.length;c++)t.default.IsPhone(o[c])||t.default.IsFixPhone(o[c])?(r=!0,n.Phone=o[c]):s.push(o[c]);if(!r)return e.showToast({icon:"none",title:"未识别出有效的电话号码"});console.log("arr",s);for(c=0;c<s.length;c++)""!=s[c]&&"浙江省"!=s[c]&&"金华市"!=s[c]&&"义乌市"!=s[c]||(s.splice(c,1),c--);console.log("arr",s);var u="",g="";for(c=0;c<s.length;c++){console.log("curr:"+s[c]),0==c&&(u=s[c],g=s[c]);for(var f=0;f<s.length;f++)c!=f&&(g.length<s[f].length&&(g=s[f]),u.length>s[f].length&&(u=s[f]),console.log("name:",u),console.log("addr:",g),console.log("---------"),n.Name=u,n.Address2=g,n.location=!0)}n.GetGeo(n.Address2)}},PageReload:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"area",o=this;null!=e&&(o.RegionID=e.RegionID,o.Region=e.Region,"address"==n&&(o.Address=e.Address,o.Phone=e.Phone,o.Name=e.Name))},btnSubmit:function(){var n=this;if(t.default.IsNull(n.Lng)||t.default.IsNull(n.Lat)||t.default.IsNull(n.Address)){if(t.default.IsNull(n.Address2))return void n.showMsg("请选择定位或填写地址");n.GetGeo(n.Address2)}if(t.default.IsNull(n.Name))n.showMsg("请输入联系人姓名！");else if(0!=n.Phone.length)if(console.log(t.default.IsFixPhone(n.Phone)),t.default.IsPhone(n.Phone)||t.default.IsFixPhone(n.Phone)){for(var o=getCurrentPages(),s=-1,r=-1,i=0;i<o.length;i++)"pages/index/index"==o[i].route&&(s=i),o[i].route==n.$scope.route&&(r=i);var l=o[s];if(console.log(n),t.default.IsNull(n.Lng)||t.default.IsNull(n.Lng)||t.default.IsNull(n.Address))return n.showMsg("网络繁忙，请重试"),void console.log("空值，不能提交");console.log("可以返回提交");var a={Lng:n.Lng,Lat:n.Lat,Province:n.Province,City:n.City,District:n.District,RegionID:n.RegionID,Region:n.Region,Address:n.Address,Address2:n.Address2,Address3:n.Address3,Name:n.Name,Phone:n.Phone};if(l.$vm.PageReload(a,n.Type,n.Address,n.Address2),n.Agreement){var d={lng:n.Lng,lat:n.Lat,province:n.Province,city:n.City,district:n.District,regionID:n.RegionID,regionName:n.Region,address:n.Address,address2:n.Address2,address3:n.Address3,fullName:n.Name,phone:n.Phone,remark:"",IsDefault:!1};"receipt"==n.Type?d.type=1:d.type=2,n.POST("/api/User/CreateCommonlyUsedContact",d,n.userInfo.accessToken,(function(e){}))}e.navigateBack({delta:r-s})}else n.showMsg("请输入有效的电话号码");else n.showMsg("请输入联系人电话")}},onLoad:function(e){var n=this;n.Type=e.type;var o=JSON.parse(decodeURIComponent(e.address));"receipt"==n.Type&&(n.Title="收件人信息"),n.Lng=o.Lng||"",n.Lat=o.Lat||"",n.Address=o.Address,n.Address2=o.Address2?o.Address2:n.Address2,n.Address3=o.Address3?o.Address3:"",n.Province=o.Province||"",n.City=o.City||"",n.District=o.District||"",n.Name=o.FullName||"",n.Phone="receipt"===n.Type||o.Phone&&11==o.Phone.length?o.Phone:n.userInfo.Mobile,n.RegionID=o.RegionID,n.Region=o.RegionName}};n.default=u}).call(this,o("543d")["default"])},"78db":function(e,n,o){},"7c2d":function(e,n,o){"use strict";o.r(n);var t=o("4639"),s=o.n(t);for(var r in t)"default"!==r&&function(e){o.d(n,e,(function(){return t[e]}))}(r);n["default"]=s.a},a431:function(e,n,o){"use strict";o.r(n);var t=o("d0bf"),s=o("7c2d");for(var r in s)"default"!==r&&function(e){o.d(n,e,(function(){return s[e]}))}(r);o("c375");var i,l=o("f0c5"),a=Object(l["a"])(s["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],i);n["default"]=a.exports},c375:function(e,n,o){"use strict";var t=o("78db"),s=o.n(t);s.a},d0bf:function(e,n,o){"use strict";var t;o.d(n,"b",(function(){return s})),o.d(n,"c",(function(){return r})),o.d(n,"a",(function(){return t}));var s=function(){var e=this,n=e.$createElement;e._self._c},r=[]}},[["44a4","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/orderConfirm"],{"03c0":function(e,t,o){"use strict";(function(e){o("03cd");n(o("66fd"));var t=n(o("44c6"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},3218:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(o("7a58")),a=o("2f62");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){u(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function u(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var d={data:function(){return{Agreement:!1,btnDisable:!1,OrderData:{},coupon:{Amount:0,Name:"",couponId:0},totalMoney:0}},computed:i({},(0,a.mapState)(["hasLogin","userInfo"])),methods:{btnUse:function(){e.navigateTo({url:"couponList"})},LoadCoupon:function(t){var o=this;return t?o.totalMoney<t.Amount?(e.showToast({icon:"none",title:"优惠券总价不能大于运费！"}),o.coupon.Amount=0,o.coupon.couponId=0,void(o.coupon.Name="")):t.IsUsed?(e.showToast({icon:"none",title:"该优惠券已经使用！"}),o.coupon.Amount=0,o.coupon.couponId=0,void(o.coupon.Name="")):(o.coupon.Amount=t.Amount,o.coupon.couponId=t.couponId,o.coupon.Name=t.Name,void(o.OrderData.couponID=t.couponId)):(o.coupon.Amount=0,o.coupon.couponId=0,void(o.coupon.Name=""))},agreementChange:function(){var e=this;e.Agreement=!e.Agreement},LoadData:function(){var t=this,o="/api/Region/GetRegionConfig?startRegionID="+t.OrderData.mailingRegionID+"&endRegionID="+t.OrderData.receiptRegionID;t.Get(o,"",t.userInfo.accessToken,(function(o){if(o.Status&&o.Data){var n=o.Data,a=t.OrderData.weight,r=n.Weight,c=n.Price,i=a-r,u=n.ExceedWeightPrice1,d=(n.ExceedWeightPrice2,n.UrgentPrice,n.UrgentCoefficient),l=n.PriceDis,s=n.ExceedWeightRange1,f=n.ExceedWeightRange2,p=n.ExceedWeightRange3,g=n.ExceedWeightFixedPrice1,O=n.ExceedWeightFixedPrice2,h=n.ExceedWeightFixedPrice3,m=0;console.log("_weight",a),a>p?(t.totalMoney=h+m,console.log("重量超过"+p+"千克,订单价格:"+t.totalMoney+"元")):f<a&&a<=p?(t.totalMoney=O+m,console.log("重量在"+f+"千克-"+p+"千克之间,订单价格:"+t.totalMoney+"元")):s<a&&a<=f?(t.totalMoney=g+m,console.log("重量在"+s+"千克-"+f+"千克之间,订单价格:"+t.totalMoney+"元")):r<a&&a<=s?(m=i*u,t.totalMoney=c+m,console.log("重量在"+r+"千克-"+s+"千克之间,订单价格:"+t.totalMoney+"元")):(t.totalMoney=c,console.log("重量"+a+"千克,订单价格:"+t.totalMoney+"元")),t.OrderData.startWeight=r,t.OrderData.startPrice=c,t.OrderData.exceedPrice=m,t.OrderData.exceedWeight=0==m?0:i,t.totalMoney=t.OrderData.expedited?t.totalMoney*d*l:t.totalMoney*l,t.totalMoney=t.totalMoney.toFixed(2),t.OrderData.startWeight=r,t.OrderData.cost=t.totalMoney}else e.showToast({icon:"none",title:"数据获取失败！"}),t.btnDisable=!0}))},btnLoad:function(){var t=this;if(!n.default.IsInt(t.OrderData.weight)||Number(t.OrderData.weight)<1)t.showMsg("请重新选择物品重量！");else if(!n.default.IsNumber(t.totalMoney)||Number(t.totalMoney)<=0)t.showMsg("运费计算错误，请重新操作！");else{if(t.totalMoney<t.coupon.Amount)return e.showToast({icon:"none",title:"优惠券总价不能大于运费！"}),t.coupon.Amount=0,t.coupon.couponId=0,void(t.coupon.Name="");t.OrderData.cost=t.totalMoney-t.coupon.Amount,e.showModal({title:"提示",content:"请再次确认订单信息！",cancelColor:"#FF3333",success:function(o){o.confirm&&t.POST("/api/Order/CreateOrder",t.OrderData,t.userInfo.accessToken,(function(o){o.Status&&(1==t.OrderData.fareArrivePay?e.reLaunch({url:"/pages/index/loadSuccess"}):e.reLaunch({url:"/pages/index/orderPay?orderid="+o.Data.OrderID}))}),"biz")}})}}},onLoad:function(t){var o=this,a=decodeURIComponent(t.data);n.default.IsNull(a)?e.navigateBack({delta:1}):(o.OrderData=JSON.parse(a),n.default.IsNull(o.OrderData)?e.navigateBack({delta:1}):o.LoadData())}};t.default=d}).call(this,o("543d")["default"])},"44c6":function(e,t,o){"use strict";o.r(t);var n=o("a118"),a=o("a0e8");for(var r in a)"default"!==r&&function(e){o.d(t,e,(function(){return a[e]}))}(r);o("6e8c");var c,i=o("f0c5"),u=Object(i["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);t["default"]=u.exports},"6d76":function(e,t,o){},"6e8c":function(e,t,o){"use strict";var n=o("6d76"),a=o.n(n);a.a},a0e8:function(e,t,o){"use strict";o.r(t);var n=o("3218"),a=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},a118:function(e,t,o){"use strict";var n;o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return r})),o.d(t,"a",(function(){return n}));var a=function(){var e=this,t=e.$createElement;e._self._c},r=[]}},[["03c0","common/runtime","common/vendor"]]]);